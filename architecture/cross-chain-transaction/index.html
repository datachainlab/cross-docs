<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Cross-chain Transaction | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datachainlab.github.io/cross-docs/architecture/cross-chain-transaction"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Cross-chain Transaction | My Site"><meta data-react-helmet="true" name="description" content="Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel."><meta data-react-helmet="true" property="og:description" content="Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel."><link data-react-helmet="true" rel="shortcut icon" href="/cross-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://datachainlab.github.io/cross-docs/architecture/cross-chain-transaction"><link data-react-helmet="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/architecture/cross-chain-transaction" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/ja/architecture/cross-chain-transaction" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/architecture/cross-chain-transaction" hreflang="x-default"><link rel="stylesheet" href="/cross-docs/assets/css/styles.884c4f18.css">
<link rel="preload" href="/cross-docs/assets/js/runtime~main.b2090aec.js" as="script">
<link rel="preload" href="/cross-docs/assets/js/main.8fb7ebe9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cross-docs/"><b class="navbar__title">Cross Framework Docs</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/cross-docs/architecture/cross-chain-transaction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/cross-docs/ja/architecture/cross-chain-transaction" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">æ—¥æœ¬èªž</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/datachainlab/cross-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/cross-docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/getting-started/install">Install</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Architecture</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/architecture/overview">Overivew</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/architecture/smart-contract">Smart Contract</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cross-docs/architecture/cross-chain-transaction">Cross-chain Transaction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/architecture/atomic-commit-protocol">Atomic commit protocol</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/architecture/state-store">State store</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cross-chain Transaction</h1></header><p>Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel.</p><p>Cross Framework supports multiple atomic commit protocols and provides a state store that supports state commit, rollback, and concurrency control.</p><p>A chain that receives a request from a user verifies the contents of the request and sends a packet containing a contract invocation request to the specified chain to initiate a transaction. The chain that receives the user&#x27;s request to initiate a transaction is called the initiator chain. Once the initiator chain receives a request, it processes the approval by each Account and then executes the Atomic commit flow according to the specified format.</p><p>For example, the initiator chain acts as a coordinator when executing Two-phase commit. First, the coordinator requests each participant chain to execute the contract function. Next, the coordinator gets the result of each call and decides whether or not to commit. After receiving the final decision, each participant chain commits or aborts the change.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="account"></a>Account<a class="hash-link" href="#account" title="Direct link to heading">#</a></h2><p>An account is an entity that can send transactions to a blockchain. Typically, they are required to be uniquely identified within a given blockchain. Also, accounts in one chain are generally not interoperable with accounts in another chain because each blockchain has a different concept of account and a different representation scheme.</p><p>Cross-chain contract authentication can support a variety of authentication methods by allowing accounts on any blockchain to be used. In Cross Framework, an account consists of an <code>ID</code>, which is an identifier of a user on each blockchain, and authentication information called <code>AuthType</code>. Thus, it is possible to identify accounts on different chains.
See <a href="#authentication">here</a> for information on the authentication methods supported by Cross Framework.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly proto"><pre tabindex="0" class="prism-code language-proto codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message Account {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes id = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthType auth_type = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">message AuthType {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthMode mode = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any option = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">enum AuthMode {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_UNSPECIFIED = 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_LOCAL       = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_CHANNEL     = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_EXTENSION   = 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>AuthMode</code> is an identifier that refers to the authentication method, and <code>option</code> is the authentication information defined for each <code>AuthMode</code>. For <code>AUTH_MODE_CHANNEL</code>, the <code>option</code> contains the Channel information, and for <code>AUTH_MODE_EXTENSION</code>, the definition of the Extension protobuf.Any. Details of transaction authentication are described in <a href="#authentication">Authentication</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="initiate-transaction"></a>Initiate Transaction<a class="hash-link" href="#initiate-transaction" title="Direct link to heading">#</a></h2><p>A user creates a transaction defined as <code>MsgInitiateTx</code> below and submits it to a chain to initiate a transaction. The chain to which <code>MsgInitiateTx</code> is submitted is called the initiator chain.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly protobuf"><pre tabindex="0" class="prism-code language-protobuf codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgInitiateTx {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  string chain_id = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 nonce    = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cross.core.tx.CommitProtocol commit_protocol = 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.initiator.ContractTransaction contract_transactions = 4;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 5;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ibc.core.client.v1.Height timeout_height = 6;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 timeout_timestamp = 7;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">message ContractTransaction {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes call_info = 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cross.core.tx.ReturnValue return_value = 4;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated Link links = 5;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>MsgInitiateTx</code> consists mainly of the following elements:</p><ul><li><code>contract_transactions</code>: an array of Contract Transactions that execute <a href="/cross-docs/architecture/overview#contract-module">Contract Module</a> on each chain</li><li><code>commit_protocol</code>: The commit protocol for the transaction</li><li><code>timeout_height</code>, <code>timeout_timestamp</code>: Specify the timeout for the transaction. The transaction will not be executed if the timeout is exceeded</li></ul><p>A Contract Transaction consists of the following elements:</p><ul><li><code>cross_chain_channel</code>: The IBC channel between the initiator chain and the chain where the contract to be executed exists</li><li><code>signers</code>: An array of <code>Accounts</code> that need to be authenticated</li><li><code>callInfo</code>: Call information including contract identifier, function name, and arguments. The format is <a href="/cross-docs/architecture/overview#contract-module">Contract Module</a> specification</li><li><code>return_value</code>: The return value expected from the execution of this contract (optional)</li><li><code>links</code>: Optional results of other contract calls that will be referenced when this contract is executed. See the <a href="#link">Link</a> section for details</li></ul><p>When a <code>MsgInitiateTx</code> is submitted, it is processed by the <a href="/cross-docs/architecture/overview">Tx Initiator</a>. The Tx Initiator then does the following:</p><ul><li>Generate a TxID from the <code>MsgInitiateTx</code>, verifies that it has not been submitted, and saves the TxID and the <code>MsgInitiateTx</code></li><li>Check if <code>commit_protocol</code> is supported by the initiator chain.</li><li>Ensure that <code>timeout_height</code> and <code>timeout_timestamp</code> have not passed</li></ul><p>After these processes, <a href="#link">Link processing</a> is performed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="link"></a>Link<a class="hash-link" href="#link" title="Direct link to heading">#</a></h2><p>Link is functionality to associate contract transactions that make <a href="/cross-docs/architecture/smart-contract">cross-chain calls</a>. The initiator chain resolves each link to the corresponding result of the call using Linker when the <code>MsgInitiateTx</code> is submitted.</p><p>The following points should be considered when calling cross-chain contract functions:</p><ol><li>Each contract function may be executed in parallel on each chain</li><li>The execution of an external contract function must be atomic to the execution of its caller function</li><li>the calling function can reference the return value from the execution of the external contract function</li></ol><p>Point 1. is guaranteed to be serializable by the locking mechanism in <a href="/cross-docs/architecture/state-store">State store</a>, and point 2. is guaranteed by <a href="/cross-docs/architecture/atomic-commit-protocol">Atomic commit protocol</a>. Link is a functionality to realize point 3. and the submitter of a transaction can associate it by specifying the chain to be referred to as <code>links</code> in a <code>ContractTransaction</code> that performs a cross-chain call. Note that Link is represented as the index of the referenced <code>ContractTransaction</code> in <code>contract_transactions</code>.</p><p>The Contract Transaction (calleeTx) pointed to by Link and the Contract Transaction (callerTx) referring to Link are processed as follows:</p><ol><li>The Linker generates a <code>CallResult</code> whose key is composed of <code>call_info</code> and <code>signers</code> of the calleeTx and whose value is <code>return_value</code></li><li>The Linker resolves the <code>cross_chain_channel</code> of the calleeTx to an IBC channel available to the caller. Then, it sets the resolved to the <code>CallResult</code></li><li>The TxInitiator generates a <code>ResolvedContractTransaction</code> from the callerTx&#x27;s <code>ContractTransaction</code> and <code>CallResult</code>. The definition of <code>ResolvedContractTransaction</code> is as follows</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly proto"><pre tabindex="0" class="prism-code language-proto codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message ResolvedContractTransaction {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes call_info = 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ReturnValue return_value = 4;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated google.protobuf.Any call_results = 5; // List of CallResult</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After resolving the link, the TxInitiator performs the <a href="#authentication">authentication process</a> of the Transaction.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="authentication"></a>Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">#</a></h2><p>Transaction authentication is performed by the <a href="/cross-docs/architecture/overview#authenticator">Authenticator</a>. The Authenticator provides authentication methods for the initiator chain and other chains connected by the IBC channel.</p><p>Authentication of a transaction is performed by the accounts specified in <code>signers</code> of each contract transaction in <code>contract_transactions</code>. The execution is blocked until the authentication is completed.</p><p>The authentication must satisfy each account&#x27;s method specified in <code>AuthType</code>. A corresponding Msg, where the target TxID is set, is defined for each authentication method, and authorization is possible by satisfying the specified one.</p><p>Currently, <code>SignTx</code>, <code>IBCSignTx</code>, and <code>ExtSignTx</code> are supported as authentication methods. The definitions of each method and their corresponding Msg are described below.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="signtx"></a>SignTx<a class="hash-link" href="#signtx" title="Direct link to heading">#</a></h3><p>SignTx is a method that uses the authentication method of the chain in which the transaction is submitted. It can authenticate accounts with <code>AuthMode</code> specified as <code>AUTH_MODE_LOCAL</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly proto"><pre tabindex="0" class="prism-code language-proto codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgSignTx {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated bytes signers = 2; // List of Account IDs</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ibcsigntx"></a>IBCSignTx<a class="hash-link" href="#ibcsigntx" title="Direct link to heading">#</a></h3><p>IBCSignTx is a method that uses the authentication method of the chain connected by the IBC channel to the chain where the transaction was submitted. It can authenticate accounts whose <code>AuthMode</code> are specified by <code>AUTH_MODE_CHANNEL</code>. Note that the accounts should have the information of the IBC channel to allow authentication as <code>option</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly proto"><pre tabindex="0" class="prism-code language-proto codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgIBCSignTx {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated bytes signers = 3; // List of Account IDs</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ibc.core.client.v1.Height timeout_height = 4;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 timeout_timestamp = 5;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="extsigntx"></a>ExtSignTx<a class="hash-link" href="#extsigntx" title="Direct link to heading">#</a></h3><p>ExtSignTx is a method that performs authentication according to a developer-defined authentication formula. It can authenticate accounts whose <code>AuthMode</code> are specified as <code>AUTH_MODE_EXTENSION</code>.</p><p>The corresponding account has to hold proto.Message that implements AuthExtensionVerifier as <code>option</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly proto"><pre tabindex="0" class="prism-code language-proto codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgExtSignTx {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated Account signers = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> AuthExtensionVerifier </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Message</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Verify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer Account</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signature signing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SignatureV2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>See <a href="https://github.com/datachainlab/cross/blob/v0.2.0/simapp/samplemod/types/auth.go" target="_blank" rel="noopener noreferrer">here</a> for an example of such an extended authentication implementation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="transaction-execution"></a>Transaction Execution<a class="hash-link" href="#transaction-execution" title="Direct link to heading">#</a></h2><p>After all authentication of the transaction is completed, <code>Tx Runner</code> starts the flow of Atomic Commit according to the <code>commit_protocol</code>. Each step of the flow sends a packet including the <code>ResolvedContractTransaction</code> corresponding to each chain; For more information on the different types of commit flows and the details of each, see <a href="/cross-docs/architecture/atomic-commit-protocol">the Atomic commit protocol chapter</a>.</p><p>On each chain, a contract is processed as follows:</p><ul><li>Process a <code>ResolvedContractTransaction</code> and returns it to <a href="/cross-docs/architecture/overview#contract-module">Contract Module</a></li><li>If the contract contains cross-chain calls, verify that the arguments <code>ChannelInfo</code> and <code>ContractCallInfo</code> of the <code>Call</code> match the values of <code>CallResult</code> of the corresponding <code>ResolvedContractTransaction</code></li><li>After the contract is executed, call the Contract Manager&#x27;s Precommit or CommitImmediately depending on the commit flow to save the status</li></ul><p>Regardless of the type of Commit flow, it is guaranteed that the update will only be committed if all Contract Transactions included in <code>MsgInitiateTx</code> are successfully executed, and if any of them fail, all Contract Transactions will be aborted.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cross-docs/architecture/smart-contract"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Smart Contract</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cross-docs/architecture/atomic-commit-protocol"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Atomic commit protocol Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#account" class="table-of-contents__link">Account</a></li><li><a href="#initiate-transaction" class="table-of-contents__link">Initiate Transaction</a></li><li><a href="#link" class="table-of-contents__link">Link</a></li><li><a href="#authentication" class="table-of-contents__link">Authentication</a><ul><li><a href="#signtx" class="table-of-contents__link">SignTx</a></li><li><a href="#ibcsigntx" class="table-of-contents__link">IBCSignTx</a></li><li><a href="#extsigntx" class="table-of-contents__link">ExtSignTx</a></li></ul></li><li><a href="#transaction-execution" class="table-of-contents__link">Transaction Execution</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/cross-docs/">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/datachain_en" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/datachainlab/cross-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Datachain, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cross-docs/assets/js/runtime~main.b2090aec.js"></script>
<script src="/cross-docs/assets/js/main.8fb7ebe9.js"></script>
</body>
</html>