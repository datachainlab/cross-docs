<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-docs/architecture/cross-chain-transaction">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Cross-chain Transaction | Cross Framework Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://datachainlab.github.io/cross-docs/docs/architecture/cross-chain-transaction"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cross-chain Transaction | Cross Framework Docs"><meta data-rh="true" name="description" content="Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel."><meta data-rh="true" property="og:description" content="Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel."><link data-rh="true" rel="icon" href="/cross-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://datachainlab.github.io/cross-docs/docs/architecture/cross-chain-transaction"><link data-rh="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/docs/architecture/cross-chain-transaction" hreflang="en"><link data-rh="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/ja/docs/architecture/cross-chain-transaction" hreflang="ja"><link data-rh="true" rel="alternate" href="https://datachainlab.github.io/cross-docs/docs/architecture/cross-chain-transaction" hreflang="x-default"><link rel="stylesheet" href="/cross-docs/assets/css/styles.6a91212d.css">
<link rel="preload" href="/cross-docs/assets/js/runtime~main.50b8895f.js" as="script">
<link rel="preload" href="/cross-docs/assets/js/main.9f4ecb77.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cross-docs/"><b class="navbar__title text--truncate">Cross Framework Docs</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cross-docs/docs/architecture/cross-chain-transaction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/cross-docs/ja/docs/architecture/cross-chain-transaction" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/datachainlab/cross" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cross-docs/">Docs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/cross-docs/docs/getting-started/install">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/docs/getting-started/install">Install</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cross-docs/docs/architecture/overview">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/docs/architecture/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/docs/architecture/smart-contract">Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cross-docs/docs/architecture/cross-chain-transaction">Cross-chain Transaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/docs/architecture/atomic-commit-protocol">Atomic commit protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/docs/architecture/state-store">State store</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/cross-docs/tutorial/overview">Tutorial</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/create-contract-module">Create contract modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/create-blockchain-app">Create Blockchain Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/create-command-cli">Create Command CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cross-docs/tutorial/execution">Execution</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cross-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Docs</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Architecture</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cross-chain Transaction</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Cross-chain Transaction</h1><p>Cross-chain Transaction is a distributed transaction executed between chains connected by IBC channel.</p><p>Cross Framework supports multiple atomic commit protocols and provides a state store that supports state commit, rollback, and concurrency control.</p><p>A chain that receives a request from a user verifies the contents of the request and sends a packet containing a contract invocation request to the specified chain to initiate a transaction. The chain that receives the user&#x27;s request to initiate a transaction is called the initiator chain. Once the initiator chain receives a request, it processes the approval by each Account and then executes the Atomic commit flow according to the specified format.</p><p>For example, the initiator chain acts as a coordinator when executing Two-phase commit. First, the coordinator requests each participant chain to execute the contract function. Next, the coordinator gets the result of each call and decides whether or not to commit. After receiving the final decision, each participant chain commits or aborts the change.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="account">Account<a href="#account" class="hash-link" aria-label="Direct link to Account" title="Direct link to Account">​</a></h2><p>An account is an entity that can send transactions to a blockchain. Typically, they are required to be uniquely identified within a given blockchain. Also, accounts in one chain are generally not interoperable with accounts in another chain because each blockchain has a different concept of account and a different representation scheme.</p><p>Cross-chain contract authentication can support a variety of authentication methods by allowing accounts on any blockchain to be used. In Cross Framework, an account consists of an <code>ID</code>, which is an identifier of a user on each blockchain, and authentication information called <code>AuthType</code>. Thus, it is possible to identify accounts on different chains.
See <a href="#authentication">here</a> for information on the authentication methods supported by Cross Framework.</p><div class="language-proto codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-proto codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message Account {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes id = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthType auth_type = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message AuthType {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthMode mode = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any option = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum AuthMode {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_UNSPECIFIED = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_LOCAL       = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_CHANNEL     = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AUTH_MODE_EXTENSION   = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>AuthMode</code> is an identifier that refers to the authentication method, and <code>option</code> is the authentication information defined for each <code>AuthMode</code>. For <code>AUTH_MODE_CHANNEL</code>, the <code>option</code> contains the Channel information, and for <code>AUTH_MODE_EXTENSION</code>, the definition of the Extension protobuf.Any. Details of transaction authentication are described in <a href="#authentication">Authentication</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initiate-transaction">Initiate Transaction<a href="#initiate-transaction" class="hash-link" aria-label="Direct link to Initiate Transaction" title="Direct link to Initiate Transaction">​</a></h2><p>A user creates a transaction defined as <code>MsgInitiateTx</code> below and submits it to a chain to initiate a transaction. The chain to which <code>MsgInitiateTx</code> is submitted is called the initiator chain.</p><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgInitiateTx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string chain_id = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 nonce    = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cross.core.tx.CommitProtocol commit_protocol = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.initiator.ContractTransaction contract_transactions = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ibc.core.client.v1.Height timeout_height = 6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 timeout_timestamp = 7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message ContractTransaction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes call_info = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cross.core.tx.ReturnValue return_value = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated Link links = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>MsgInitiateTx</code> consists mainly of the following elements:</p><ul><li><code>contract_transactions</code>: an array of Contract Transactions that execute <a href="/cross-docs/docs/architecture/overview#contract-module">Contract Module</a> on each chain</li><li><code>commit_protocol</code>: The commit protocol for the transaction</li><li><code>timeout_height</code>, <code>timeout_timestamp</code>: Specify the timeout for the transaction. The transaction will not be executed if the timeout is exceeded</li></ul><p>A Contract Transaction consists of the following elements:</p><ul><li><code>cross_chain_channel</code>: The IBC channel between the initiator chain and the chain where the contract to be executed exists</li><li><code>signers</code>: An array of <code>Accounts</code> that need to be authenticated</li><li><code>callInfo</code>: Call information including contract identifier, function name, and arguments. The format is <a href="/cross-docs/docs/architecture/overview#contract-module">Contract Module</a> specification</li><li><code>return_value</code>: The return value expected from the execution of this contract (optional)</li><li><code>links</code>: Optional results of other contract calls that will be referenced when this contract is executed. See the <a href="#link">Link</a> section for details</li></ul><p>When a <code>MsgInitiateTx</code> is submitted, it is processed by the <a href="/cross-docs/docs/architecture/overview#tx-initiator">Tx Initiator</a>. The Tx Initiator then does the following:</p><ul><li>Generate a TxID from the <code>MsgInitiateTx</code>, verifies that it has not been submitted, and saves the TxID and the <code>MsgInitiateTx</code></li><li>Check if <code>commit_protocol</code> is supported by the initiator chain.</li><li>Ensure that <code>timeout_height</code> and <code>timeout_timestamp</code> have not passed</li></ul><p>After these processes, <a href="#link">Link processing</a> is performed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="link">Link<a href="#link" class="hash-link" aria-label="Direct link to Link" title="Direct link to Link">​</a></h2><p>Link is functionality to associate contract transactions that make <a href="/cross-docs/docs/architecture/smart-contract#cross-chain-calls">cross-chain calls</a>. The initiator chain resolves each link to the corresponding result of the call using Linker when the <code>MsgInitiateTx</code> is submitted.</p><p>The following points should be considered when calling cross-chain contract functions:</p><ol><li>Each contract function may be executed in parallel on each chain</li><li>The execution of an external contract function must be atomic to the execution of its caller function</li><li>the calling function can reference the return value from the execution of the external contract function</li></ol><p>Point 1. is guaranteed to be serializable by the locking mechanism in <a href="/cross-docs/docs/architecture/state-store">State store</a>, and point 2. is guaranteed by <a href="/cross-docs/docs/architecture/atomic-commit-protocol">Atomic commit protocol</a>. Link is a functionality to realize point 3. and the submitter of a transaction can associate it by specifying the chain to be referred to as <code>links</code> in a <code>ContractTransaction</code> that performs a cross-chain call. Note that Link is represented as the index of the referenced <code>ContractTransaction</code> in <code>contract_transactions</code>.</p><p>The Contract Transaction (calleeTx) pointed to by Link and the Contract Transaction (callerTx) referring to Link are processed as follows:</p><ol><li>The Linker generates a <code>CallResult</code> whose key is composed of <code>call_info</code> and <code>signers</code> of the calleeTx and whose value is <code>return_value</code></li><li>The Linker resolves the <code>cross_chain_channel</code> of the calleeTx to an IBC channel available to the caller. Then, it sets the resolved to the <code>CallResult</code></li><li>The TxInitiator generates a <code>ResolvedContractTransaction</code> from the callerTx&#x27;s <code>ContractTransaction</code> and <code>CallResult</code>. The definition of <code>ResolvedContractTransaction</code> is as follows</li></ol><div class="language-proto codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-proto codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message ResolvedContractTransaction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated cross.core.auth.Account signers = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes call_info = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ReturnValue return_value = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated google.protobuf.Any call_results = 5; // List of CallResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After resolving the link, the TxInitiator performs the <a href="#authentication">authentication process</a> of the Transaction.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentication">Authentication<a href="#authentication" class="hash-link" aria-label="Direct link to Authentication" title="Direct link to Authentication">​</a></h2><p>Transaction authentication is performed by the <a href="/cross-docs/docs/architecture/overview#authenticator">Authenticator</a>. The Authenticator provides authentication methods for the initiator chain and other chains connected by the IBC channel.</p><p>Authentication of a transaction is performed by the accounts specified in <code>signers</code> of each contract transaction in <code>contract_transactions</code>. The execution is blocked until the authentication is completed.</p><p>The authentication must satisfy each account&#x27;s method specified in <code>AuthType</code>. A corresponding Msg, where the target TxID is set, is defined for each authentication method, and authorization is possible by satisfying the specified one.</p><p>Currently, <code>SignTx</code>, <code>IBCSignTx</code>, and <code>ExtSignTx</code> are supported as authentication methods. The definitions of each method and their corresponding Msg are described below.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="signtx">SignTx<a href="#signtx" class="hash-link" aria-label="Direct link to SignTx" title="Direct link to SignTx">​</a></h3><p>SignTx is a method that uses the authentication method of the chain in which the transaction is submitted. It can authenticate accounts with <code>AuthMode</code> specified as <code>AUTH_MODE_LOCAL</code>.</p><div class="language-proto codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-proto codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgSignTx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated bytes signers = 2; // List of Account IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ibcsigntx">IBCSignTx<a href="#ibcsigntx" class="hash-link" aria-label="Direct link to IBCSignTx" title="Direct link to IBCSignTx">​</a></h3><p>IBCSignTx is a method that uses the authentication method of the chain connected by the IBC channel to the chain where the transaction was submitted. It can authenticate accounts whose <code>AuthMode</code> are specified by <code>AUTH_MODE_CHANNEL</code>. Note that the accounts should have the information of the IBC channel to allow authentication as <code>option</code>.</p><div class="language-proto codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-proto codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgIBCSignTx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  google.protobuf.Any cross_chain_channel = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated bytes signers = 3; // List of Account IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ibc.core.client.v1.Height timeout_height = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 timeout_timestamp = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extsigntx">ExtSignTx<a href="#extsigntx" class="hash-link" aria-label="Direct link to ExtSignTx" title="Direct link to ExtSignTx">​</a></h3><p>ExtSignTx is a method that performs authentication according to a developer-defined authentication formula. It can authenticate accounts whose <code>AuthMode</code> are specified as <code>AUTH_MODE_EXTENSION</code>.</p><p>The corresponding account has to hold proto.Message that implements AuthExtensionVerifier as <code>option</code>.</p><div class="language-proto codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-proto codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message MsgExtSignTx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bytes txID = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repeated Account signers = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> AuthExtensionVerifier </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Verify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer Account</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signature signing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SignatureV2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="https://github.com/datachainlab/cross/blob/v0.2.0/simapp/samplemod/types/auth.go" target="_blank" rel="noopener noreferrer">here</a> for an example of such an extended authentication implementation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-execution">Transaction Execution<a href="#transaction-execution" class="hash-link" aria-label="Direct link to Transaction Execution" title="Direct link to Transaction Execution">​</a></h2><p>After all authentication of the transaction is completed, <code>Tx Runner</code> starts the flow of Atomic Commit according to the <code>commit_protocol</code>. Each step of the flow sends a packet including the <code>ResolvedContractTransaction</code> corresponding to each chain; For more information on the different types of commit flows and the details of each, see <a href="/cross-docs/docs/architecture/atomic-commit-protocol">the Atomic commit protocol chapter</a>.</p><p>On each chain, a contract is processed as follows:</p><ul><li>Process a <code>ResolvedContractTransaction</code> and returns it to <a href="/cross-docs/docs/architecture/overview#contract-module">Contract Module</a></li><li>If the contract contains cross-chain calls, verify that the arguments <code>ChannelInfo</code> and <code>ContractCallInfo</code> of the <code>Call</code> match the values of <code>CallResult</code> of the corresponding <code>ResolvedContractTransaction</code></li><li>After the contract is executed, call the Contract Manager&#x27;s Precommit or CommitImmediately depending on the commit flow to save the status</li></ul><p>Regardless of the type of Commit flow, it is guaranteed that the update will only be committed if all Contract Transactions included in <code>MsgInitiateTx</code> are successfully executed, and if any of them fail, all Contract Transactions will be aborted.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/cross-docs/docs/architecture/smart-contract"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Smart Contract</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cross-docs/docs/architecture/atomic-commit-protocol"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Atomic commit protocol</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#account" class="table-of-contents__link toc-highlight">Account</a></li><li><a href="#initiate-transaction" class="table-of-contents__link toc-highlight">Initiate Transaction</a></li><li><a href="#link" class="table-of-contents__link toc-highlight">Link</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a><ul><li><a href="#signtx" class="table-of-contents__link toc-highlight">SignTx</a></li><li><a href="#ibcsigntx" class="table-of-contents__link toc-highlight">IBCSignTx</a></li><li><a href="#extsigntx" class="table-of-contents__link toc-highlight">ExtSignTx</a></li></ul></li><li><a href="#transaction-execution" class="table-of-contents__link toc-highlight">Transaction Execution</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cross-docs/">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/datachain_en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/datachainlab/cross" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Datachain, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cross-docs/assets/js/runtime~main.50b8895f.js"></script>
<script src="/cross-docs/assets/js/main.9f4ecb77.js"></script>
</body>
</html>